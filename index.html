<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>الإجازة الداخلية</title>
<style>
  body {
    font-family: "Tahoma", sans-serif;
    background-image: url('https://raw.githubusercontent.com/xhhp1/medicaljpg/main/medic.jpg.jpg');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    padding: 30px;
    text-align: right;
    color: #000;
  }
  .overlay {
    background-color: rgba(255, 255, 255, 0.9);
    border-radius: 20px;
    max-width: 550px;
    margin: auto;
    padding: 25px 30px;
    box-shadow: 0 0 15px rgba(0,0,0,0.3);
  }
  h2 {
    text-align: center;
    color: #8B0000;
  }
  label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
  }
  input, select {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    border-radius: 8px;
    border: 1px solid #ccc;
    text-align: right;
    font-size: 15px;
  }
  .time-group {
    display: flex;
    gap: 10px;
  }
  .time-group input, .time-group select {
    flex: 1;
  }
  button {
    margin-top: 15px;
    padding: 10px 20px;
    background-color: #8B0000;
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 16px;
    width: 100%;
  }
  button:hover {
    background-color: #a91c1c;
  }
  pre {
    background: #ffffffcc;
    padding: 15px;
    border-radius: 10px;
    margin-top: 20px;
    white-space: pre-wrap;
    direction: rtl;
    border: 1px solid #ccc;
    font-size: 15px;
  }
</style>
</head>
<body>

<div class="overlay">
  <h2> الإجازة الداخلية</h2>

  <label>الكوبي يوزر:</label>
  <input type="text" id="copyUser" placeholder="أدخل الكوبي يوزر">

  <label>مدة الإجازة (بالساعات):</label>
  <input type="number" id="vac_duration" placeholder="عدد الساعات">

  <label>الرصيد المتبقي (بالساعات):</label>
  <input type="number" id="vac_balance" placeholder="عدد الساعات">

  <label>وقت بدء الإجازة:</label>
  <div class="time-group">
    <input type="number" id="vac_startHour" placeholder="الساعة (1-12)">
    <input type="number" id="vac_startMinute" placeholder="الدقيقة (0-59)">
    <select id="vac_startPeriod">
      <option value="ص">صباحًا</option>
      <option value="م">مساءً</option>
    </select>
  </div>

  <button onclick="generate()">إنشاء القرار</button>
  <button onclick="copyToClipboard()">نسخ القرار</button>

  <pre id="output"></pre>
</div>

<script>
function generate() {
  let copyUser = document.getElementById("copyUser").value.trim();
  let duration = parseFloat(document.getElementById("vac_duration").value) || 0;
  let balance = parseFloat(document.getElementById("vac_balance").value) || 0;
  let startHour = parseInt(document.getElementById("vac_startHour").value);
  let startMinute = parseInt(document.getElementById("vac_startMinute").value);
  let period = document.getElementById("vac_startPeriod").value;

  if (!startHour || startHour < 1 || startHour > 12)
    return alert("⚠️ الرجاء إدخال ساعة صحيحة (1 - 12)");
  if (isNaN(startMinute) || startMinute < 0 || startMinute > 59)
    return alert("⚠️ الرجاء إدخال دقيقة صحيحة (0 - 59)");

  // Convert AM/PM Arabic to 24-hour format
  if (period === "م" && startHour < 12) startHour += 12;
  if (period === "ص" && startHour === 12) startHour = 0;

  // Get current date in Riyadh timezone
  let tzDate = new Date(new Date().toLocaleString("en-US", { timeZone: "Asia/Riyadh" }));
  let yyyy = tzDate.getFullYear();
  let mm = String(tzDate.getMonth() + 1).padStart(2, '0');
  let dd = String(tzDate.getDate()).padStart(2, '0');

  // Build start & end times
  let startDate = new Date(`${yyyy}-${mm}-${dd}T${String(startHour).padStart(2,'0')}:${String(startMinute).padStart(2,'0')}:00`);
  let endDate = new Date(startDate);
  endDate.setHours(endDate.getHours() + duration);

  // Format the date/time nicely in Arabic
  function formatDate(date) {
    let y = date.getFullYear();
    let m = String(date.getMonth() + 1).padStart(2, '0');
    let d = String(date.getDate()).padStart(2, '0');
    let h = date.getHours();
    let min = String(date.getMinutes()).padStart(2, '0');
    let per = h >= 12 ? "م" : "ص";
    h = h % 12;
    h = h ? h : 12;
    return `${y}/${m}/${d} | ${h}:${min} ${per}`;
  }

  // Wrap ID with <@ >
  if (copyUser && !copyUser.startsWith("<@")) {
    copyUser = `<@${copyUser}>`;
  }

  let remaining = balance - duration;

  let result = `
﷽

**قرار صـادر مـن <@&1071933369698496532>**

الموضوع : إجازة داخلية

للمسعف : ${copyUser}

المدة : ${duration} ساعة

من الساعة : ${formatDate(startDate)}
إلى الساعة : ${formatDate(endDate)}

الرصيد المتبقي : ${remaining} ساعة

إعتماد :
<@&1071933358503903242>
<@725655707764129813>

<@&1071933359086911561>
<@813079786855464961>
`;

  document.getElementById("output").textContent = result;
}

function copyToClipboard() {
  const text = document.getElementById("output").textContent;
  if (!text.trim()) return alert("الرجاء إنشاء القرار أولاً");
  navigator.clipboard.writeText(text);
  alert("✅ تم نسخ القرار بنجاح!");
}
</script>

</body>
</html>


